(function(t){"use strict";function e(t,e){var n=Object.create(t);for(var r in e)n[r]=e[r];return e.toString!==Object.prototype.toString&&(n.toString=e.toString),n}function n(t){return t instanceof Array?new _(t):t.iterator()}var r=function(t){this.input=t};r.__name__=!0,r.prototype={get:function(){if(0==this.input.value.length)return null;var t=parseFloat(this.input.value);if(null!=t)return t;throw h.thrown("could not parse "+c.string(this.input)+" as float")},set:function(t){this.input.placeholder=o.toString(t,1)}};var i=function(t,e,n,r,i){this.lvlMem=t,this.hpMem=e,this.acMem=n,this.dmgMem=r,this.hitMem=i};i.__name__=!0,i.lvlEntry=function(t){var e=s.find(u.STATS,function(e){return e.lvl==t});if(null==e)throw h.thrown("level not in data table: "+t);return e},i.isCloserTo=function(t,e,n){return Math.abs(t-n)<Math.abs(e-n)},i.isSmallerAndCloserTo=function(t,e,n){return t<=n&&i.isCloserTo(t,e,n)},i.estimateLvlFromHp=function(t){return s.fold(u.STATS.slice(1),function(e,n){return i.isCloserTo(e.hp,n.hp,t)?e:n},u.DEFAULT).lvl},i.estimateLvlFromDmg=function(t){return s.fold(u.STATS.slice(1),function(e,n){return i.isCloserTo(e.dmg,n.dmg,t)?e:n},u.DEFAULT).lvl},i.playerHitProb=function(t,e){return o.clamp(.6-.05*(e-i.lvlEntry(t).ac),.05,.95)},i.creatureHitProb=function(t,e){return o.clamp(.6+.05*(e-i.lvlEntry(t).hit),.05,.95)},i.estimateLvlFromFe=function(t){return s.fold(u.STATS.slice(1),function(e,n){return i.isCloserTo(e.ferocity,n.ferocity,t)?e:n},u.DEFAULT).lvl},i.estimateLvlFromEn=function(t){return s.fold(u.STATS.slice(1),function(e,n){return i.isCloserTo(e.endurance,n.endurance,t)?e:n},u.DEFAULT).lvl},i.estimateLvlFromEnFe=function(t,e){var n=t*e,r=s.fold(u.STATS.slice(1),function(t,e){return i.isSmallerAndCloserTo(t.product,e.product,n)?t:e},u.DEFAULT).lvl,l=0;if(r!=u.MAX_LVL){var a=i.lvlEntry(r).product,c=i.lvlEntry(r+1).product;l=(n-a)/(c-a)}return o.clamp(r+l,u.MIN_LVL,u.MAX_LVL)},i.acAdjustment=function(t,e){return(o.clamp(t/e,.05,.95)-.6)/.05},i.hitAdjustment=function(t,e){return(.6-o.clamp(e/t,.05,.95))/.05},i.estimateEn=function(t,e,n,r,l,o){if(null==o&&(o=0),null!=t&&null!=e)return null==l&&(l=i.estimateLvlFromHp(t)),t/i.playerHitProb(l,e);if(null!=n&&null!=r){var s=i.estimateFe(t,e,n,r,l,o);return l=(null!=l?l:i.estimateLvlFromFe(s))+o,i.lvlEntry(l).product/s}return l=(null!=l?l:u.DEFAULT.lvl)+o,i.lvlEntry(l).endurance},i.estimateFe=function(t,e,n,r,l,o){if(null==o&&(o=0),null!=n&&null!=r)return null==l&&(l=i.estimateLvlFromDmg(n)),n*i.creatureHitProb(l,r);if(null!=t&&null!=e){var s=i.estimateEn(t,e,n,r,l,o);return l=(null!=l?l:i.estimateLvlFromEn(s))+o,i.lvlEntry(l).product/s}return l=(null!=l?l:u.DEFAULT.lvl)+o,i.lvlEntry(l).ferocity},i.prototype={endurance:function(){return null==this.enMem?this.enMem=i.estimateEn(this.hpMem,this.acMem,this.dmgMem,this.hitMem,this.lvlMem):this.enMem},ferocity:function(){return null==this.feMem?this.feMem=i.estimateFe(this.hpMem,this.acMem,this.dmgMem,this.hitMem,this.lvlMem):this.feMem},level:function(){return null!=this.lvlMem?this.lvlMem:i.estimateLvlFromEnFe(this.endurance(),this.ferocity())},hp:function(){return null!=this.hpMem?this.hpMem:null!=this.acMem?this.endurance()*i.playerHitProb(o.iround(this.level()),this.ac()):.6*this.endurance()},ac:function(){return null!=this.acMem?this.acMem:null!=this.hpMem?i.lvlEntry(o.iround(this.level())).ac-i.acAdjustment(this.hp(),this.endurance()):i.lvlEntry(o.iround(this.level())).ac},dmg:function(){return null!=this.dmgMem?this.dmgMem:null!=this.hitMem?this.ferocity()/i.creatureHitProb(o.iround(this.level()),this.hitMem):this.ferocity()/.6},hit:function(){return null!=this.hitMem?this.hitMem:null!=this.dmgMem?i.lvlEntry(o.iround(this.level())).hit-i.hitAdjustment(this.dmg(),this.ferocity()):i.lvlEntry(o.iround(this.level())).hit}};var l=function(t,e,n,r,i){this.lvl=t,this.hp=e,this.ac=n,this.dmg=r,this.hit=i,this.endurance=e/.6,this.ferocity=.6*r,this.product=this.endurance*this.ferocity};l.__name__=!0;var u=function(){};u.__name__=!0;var o=function(){};o.__name__=!0,o.clamp=function(t,e,n){return Math.max(e,Math.min(n,t))},o.round=function(t,e){return t*=Math.pow(10,e),Math.round(t)/Math.pow(10,e)},o.iround=function(t){return 0|Math.round(t)},o.toString=function(t,e){return c.string(o.round(t,e))};var s=function(){};s.__name__=!0,s.fold=function(t,e,r){for(var i=n(t);i.hasNext();)r=e(i.next(),r);return r},s.find=function(t,e){for(var r=n(t);r.hasNext();){var i=r.next();if(e(i))return i}return null};var a=function(){};a.__name__=!0,a.main=function(){var t=window.document.getElementById("level"),e=window.document.getElementById("hp"),n=window.document.getElementById("ac"),l=window.document.getElementById("dmg"),u=window.document.getElementById("hit"),o=new r(t),s=new r(e),a=new r(n),c=new r(l),h=new r(u),m=new i(null==o.get()?null:0|o.get(),s.get(),a.get(),c.get(),h.get());o.set(m.level()),s.set(m.hp()),a.set(m.ac()),c.set(m.dmg()),h.set(m.hit()),t.addEventListener("change",function(){var t=o.get(),e=s.get(),n=a.get(),r=new i(null==t?null:0|t,e,n,c.get(),h.get());o.set(r.level()),s.set(r.hp()),a.set(r.ac()),c.set(r.dmg()),h.set(r.hit())}),e.addEventListener("change",function(){var t=o.get(),e=s.get(),n=a.get(),r=new i(null==t?null:0|t,e,n,c.get(),h.get());o.set(r.level()),s.set(r.hp()),a.set(r.ac()),c.set(r.dmg()),h.set(r.hit())}),n.addEventListener("change",function(){var t=o.get(),e=s.get(),n=a.get(),r=new i(null==t?null:0|t,e,n,c.get(),h.get());o.set(r.level()),s.set(r.hp()),a.set(r.ac()),c.set(r.dmg()),h.set(r.hit())}),l.addEventListener("change",function(){var t=o.get(),e=s.get(),n=a.get(),r=new i(null==t?null:0|t,e,n,c.get(),h.get());o.set(r.level()),s.set(r.hp()),a.set(r.ac()),c.set(r.dmg()),h.set(r.hit())}),u.addEventListener("change",function(){var t=o.get(),e=s.get(),n=a.get(),r=new i(null==t?null:0|t,e,n,c.get(),h.get());o.set(r.level()),s.set(r.hp()),a.set(r.ac()),c.set(r.dmg()),h.set(r.hit())})},Math.__name__=!0;var c=function(){};c.__name__=!0,c.string=function(t){return f.__string_rec(t,"")};var h=function(t,e,n){Error.call(this,t),this.message=t,this.__previousException=e,this.__nativeException=null!=n?n:this};h.__name__=!0,h.thrown=function(t){if(t instanceof h)return t.get_native();if(t instanceof Error)return t;var e=new m(t);return e},h.__super__=Error,h.prototype=e(Error.prototype,{get_native:function(){return this.__nativeException}});var m=function(t,e,n){h.call(this,String(t),e,n),this.value=t};m.__name__=!0,m.__super__=h,m.prototype=e(h.prototype,{});var _=function(t){this.current=0,this.array=t};_.__name__=!0,_.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]}};var f=function(){};f.__name__=!0,f.__string_rec=function(t,e){if(null==t)return"null";if(e.length>=5)return"<...>";var n=typeof t;switch("function"==n&&(t.__name__||t.__ename__)&&(n="object"),n){case"function":return"<function>";case"object":if(t instanceof Array){var r="[";e+="\t";for(var i=0,l=t.length;i<l;){var u=i++;r+=(u>0?",":"")+f.__string_rec(t[u],e)}return r+="]",r}var o;try{o=t.toString}catch(i){return"???"}if(null!=o&&o!=Object.toString&&"function"==typeof o){var s=t.toString();if("[object Object]"!=s)return s}r="{\n";e+="\t";var a=null!=t.hasOwnProperty,c=null;for(c in t)a&&!t.hasOwnProperty(c)||"prototype"!=c&&"__class__"!=c&&"__super__"!=c&&"__interfaces__"!=c&&"__properties__"!=c&&(2!=r.length&&(r+=", \n"),r+=e+c+" : "+f.__string_rec(t[c],e));return e=e.substring(1),r+="\n"+e+"}",r;case"string":return t;default:return String(t)}},String.__name__=!0,Array.__name__=!0,f.__toStr={}.toString,u.STATS=[new l(-3,14.81336806,14,1.807830801,5),new l(-2,16.22723167,14,1.98037942,5),new l(-1,17.77604167,14,2.169396961,5),new l(0,19.47267801,14,2.376455304,5),new l(1,21.33125,14,2.603276353,5),new l(2,22.53402778,14,4.515669516,5),new l(3,30.04097222,14,6.428062678,5),new l(4,32.39097222,15,8.34045584,6),new l(5,53.70069444,16,10.252849,7),new l(6,54.80069444,16,12.16524217,7),new l(7,56.50694444,16,14.07763533,7),new l(8,59.20694444,17,16.16096866,8),new l(9,62.99444444,18,18.09472934,9),new l(10,62.99444444,18,20.24216524,9),new l(11,79.43541667,18,22.19729345,9),new l(12,79.43541667,18,27.48575499,9),new l(13,81.87291667,19,29.71866097,10),new l(14,89.12916667,19,31.95156695,10),new l(15,91.98125,19,34.18447293,10),new l(16,93.78125,19,40.51994302,10),new l(17,127.835,20,43.00925926,11),new l(18,127.835,20,45.4985755,11),new l(19,130.11,20,52.0477208,11),new l(20,150.9808333,20,55.60541311,11),new l(21,168.8017033,20,62.16874181,11),new l(22,188.7260417,20,69.50676638,11),new l(23,211.0021291,20,77.71092726,11),new l(24,235.9075521,20,86.88345798,11),new l(25,263.7526614,20,97.13865908,11),new l(26,294.8844401,20,108.6043225,11),new l(27,329.6908268,20,121.4233238,11),new l(28,368.6055501,20,135.7554031,11),new l(29,412.1135335,20,151.7791548,11),new l(30,460.7569377,20,169.6942539,11)],u.MIN_LVL=u.STATS[0].lvl,u.MAX_LVL=u.STATS[u.STATS.length-1].lvl,u.DEFAULT=u.STATS[4],a.main()})();